function getWeather(a,c,e){var d={};var b={};b.today=new Date();b.yesterday=new Date();b.tomorrow=new Date();b.yesterday.setDate(b.today.getDate()-1);b.tomorrow.setDate(b.today.getDate()+1);$.when($.ajax({url:"getWeather.php",type:"POST",dataType:"json",data:{latitude:a,longitude:c,time:b.today.toWeatherString()}}),$.ajax({url:"getWeather.php",type:"POST",dataType:"json",data:{latitude:a,longitude:c,time:b.tomorrow.toWeatherString()}}),$.ajax({url:"getWeather.php",type:"POST",dataType:"json",data:{latitude:a,longitude:c,time:b.yesterday.toWeatherString()}})).done(function(g,f,h){d.time=new Date();d.today=g[0];d.tomorrow=f[0];d.yesterday=h[0];if(typeof e!=="undefined"){e(d)}}).fail(function(h,i,f){var g=i+", "+f;console.log(h.responseText);console.log("Request Failed: "+g)})}function getCityFromLatLng(a,c,e){var d="http://maps.googleapis.com/maps/api/geocode/json?";var b;$.getJSON(d,{latlng:a+","+c,sensor:"true"},function(f){b="Unknown";if(typeof f.results!="undefined"&&f.results.length>1){b=f.results[1]["formatted_address"]}userLocation.city=b;if(typeof e!=="undefined"){e(b)}})}function locationError(a){$("#weatherDisplay").html('<div class="col-xs-12"><div class="alert alert-info">Your location could not be determined, please either allow geolocation or type and address below.</div></div>');console.warn("ERROR("+a.code+"): "+a.message)}function storeLocation(a,b){if(typeof a.location!="undefined"){userLocation=a.location}else{if(typeof a.coords!="undefined"){userLocation=a.coords}else{locationError(err);return}}if(typeof a.city!="undefined"&&typeof a.city.names.en!="undefined"){userLocation.city=a.city.names.en}else{userLocation.city=getCityFromLatLng(userLocation.latitude,userLocation.longitude)}userLocation.time=new Date();if(typeof b!="undefined"){getWeather(userLocation.latitude,userLocation.longitude,b)}else{getWeather(userLocation.latitude,userLocation.longitude)}}function resetResults(){$("#weatherDisplay").slideUp(0);$("#weatherDisplay").html('<img class="loading-gif" src="img/loading/simple/11.gif" />');$("#weatherDisplay").slideDown(500);$("#map-canvas").css("min-height",0)}function getWeatherFromLocation(d){var b={enableHighAccuracy:true,timeout:5000,maximumAge:0};if(navigator.geolocation){resetResults();var a=d;navigator.geolocation.getCurrentPosition(function(e){storeLocation(e,a)},locationError,b)}else{var c={code:999,message:"Not supported"};locationError(c)}}function getWeatherFromPostcode(a,b){var a=$("#postcode").val();userLocation={};userLocation.city=a;resetResults();$.ajax({url:"getAddress.php",type:"POST",dataType:"json",data:{address:a}}).done(function(c){userLocation.latitude=c.latitude;userLocation.longitude=c.longitude;if(typeof b!="undefined"){getWeather(c.latitude,c.longitude,b)}else{getWeather(c.latitude,c.longitude)}}).fail(function(e,f,c){$("#weatherDisplay").html('<div class="col-xs-12"><div class="alert alert-info">The address could not be found, please try a different address.</div></div>');var d=f+", "+c;console.log(e.responseText);console.log("Request Failed: "+d)})}function compareTemperature(d,c,g){if(typeof g==="undefined"){g="si"}var f,e;if(units[g]["temp"]=="&deg;C"){var f=CtoK(d);var e=CtoK(c)}else{if(units[g]["temp"]=="&deg;f"){var f=FtoK(d);var e=FtoK(c)}else{var f=d;var e=c}}var h=((f/e));var i;if(h<1){i="Not noticeably colder than";if(h>0.995){i="Barely noticeably colder than"}else{if(h>0.996){i="A bit colder than"}else{if(h>0.992){i="Noticeably colder than"}else{if(h>0.984){i="Quite a bit colder than"}else{if(h>0.98){i="Quite a lot colder than"}else{if(h>0.97){i="A lot colder than"}else{if(h>0.955){i="Very much colder than"}else{if(h>0.95){i="Freezing compared to"}else{if(h>0.9){i="Absolutely freezing compared to"}else{if(h<=0.9){i="Where do you live?! It's CRAZY cold compared to yesterday"}}}}}}}}}}}else{if(h===1){i="The same temperature as"}else{if(h<1.004){i="Not noticeably hotter than"}else{if(h<1.008){i="Barely noticeably hotter than"}else{if(h<1.01){i="A tiny bit hotter than"}else{if(h<1.013){i="A bit hotter than"}else{if(h<1.015){i="Just noticeably hotter than"}else{if(h<1.029){i="Noticeably hotter than"}else{if(h<1.035){i="Quite a bit hotter than"}else{if(h<1.05){i="Hotter than"}else{if(h<1.08){i="A lot hotter than"}else{if(h<1.09){i="Quite a lot hotter than"}else{if(h<1.1){i="A massive amount hotter than"}else{if(h<1.125){i="Very much hotter than"}else{if(h>=1.125){i="Scorching compared to"}}}}}}}}}}}}}}}return{text:i,diff:d-c,pdiff:f/e}}function compareWind(d,c){var e=d/c;var f;if(e<1){if(e<0.1){f="There's basically no wind compared to"}else{if(e<0.2){f="Majorly less windy than"}else{if(e<0.35){f="Significantly less windy than"}else{if(e<0.5){f="A lot less windy than"}else{if(e<0.6){f="Noticably less windy than"}else{if(e<0.75){f="A bit less windy than"}else{if(e<0.9){f="Slightly less windy than"}else{f="Ever so slightly less windy than"}}}}}}}}else{if(e===1){f="No different to"}else{if(e>1){if(e>3){f="It's a wind-fest compared to"}else{if(e>2.5){f="Majorly windier than"}else{if(e>2.2){f="Significantly windier than"}else{if(e>2){f="Noticeably windier than"}else{if(e>1.5){f="A bit windier than"}else{if(e>1.2){f="Slightly windier than"}else{f="Ever so slightly windier than"}}}}}}}}}return{text:f,diff:d-c,pdiff:d/c}}function FtoK(a){return((((a-32)*5)/9)+273.15)}function CtoK(a){return(a+273.15)};