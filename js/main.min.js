function MakeVibe(e){e=e||500;if(navigator.vibrate){navigator.vibrate(e)}}function postcodeGetSubmit(){getWeatherFromPostcode($("#postcode").val(),displayWeather)}function displayWeather(e){$("#weatherDisplay").html("");var t=64;var n=$('<div class="col-md-12 col-lg-6">');var r=$('<div class="col-md-12 col-lg-6">');console.log(units);var i=compareWind(e.today.averageWindSpeed,e.yesterday.averageWindSpeed);var s=compareTemperature(e.today.averageTemperature,e.yesterday.averageTemperature,e.today.units);var o=$('<div class="wind col-sm-6">').append("<h3>Wind</h3>").append('<h4 class="numeric">'+twoDP(e.today.averageWindSpeed)+" "+units[e.today.units]["wind"]+"</h4>").append('<h5 class="numeric">'+twoDP(e.today.precipProbability*100)+"% chance of rain</h5>").append("<p>"+i.text+" yesterday ("+addSign(twoDP(i.diff))+" "+units[e.today.units]["wind"]+")</p>");var u=$('<div class="temp col-sm-6">').append("<h3>Temperature</h3>").append('<h4 class="numeric">'+twoDP(e.today.averageTemperature)+" "+units[e.today.units]["temp"]+"</h4>").append('<h5 class="numeric">Low: '+twoDP(e.today.temperatureMin)+" "+units[e.today.units]["temp"]+" High: "+twoDP(e.today.temperatureMax)+" "+units[e.today.units]["temp"]+"</h5>").append("<p>"+s.text+" yesterday ("+addSign(twoDP(s.diff))+" "+units[e.today.units]["temp"]+")</p>");var a=$('<div class="row today title">').append($('<div class="col-md-12"><h2><a href="today.php" alt="Today\'s Weather" title="Today\'s Weather">Today</a></h2></div>')).append('<canvas id="icon-today" width="'+t+'" height="'+t+'"></canvas>');var f=$('<div class="row today summary">').append($('<div class="col-md-12">').append($("<p>"+e.today.summary+"</p>")));var l=$('<div class="row today result">').append(o).append(u);if(Math.round(s.diff)>0){n.addClass("hotter")}else if(Math.round(s.diff)<0){n.addClass("colder")}i=compareWind(e.tomorrow.averageWindSpeed,e.today.averageWindSpeed);s=compareTemperature(e.tomorrow.averageTemperature,e.today.averageTemperature,e.tomorrow.units);var o=$('<div class="wind col-sm-6">').append("<h3>Wind</h3>").append('<h4 class="numeric">'+twoDP(e.tomorrow.averageWindSpeed)+" "+units[e.tomorrow.units]["wind"]+"</h4>").append('<h5 class="numeric">'+twoDP(e.tomorrow.precipProbability*100)+"% chance of rain</h5>").append("<p>"+i.text+" today ("+addSign(twoDP(i.diff))+" "+units[e.tomorrow.units]["wind"]+")</p>");var u=$('<div class="temp col-sm-6">').append("<h3>Temperature</h3>").append('<h4 class="numeric">'+twoDP(e.tomorrow.averageTemperature)+" "+units[e.tomorrow.units]["temp"]+"</h4>").append('<h5 class="numeric">Low: '+twoDP(e.tomorrow.temperatureMin)+" "+units[e.tomorrow.units]["temp"]+" High: "+twoDP(e.tomorrow.temperatureMax)+" "+units[e.tomorrow.units]["temp"]+"</h5>").append("<p>"+s.text+" today ("+addSign(twoDP(s.diff))+" "+units[e.tomorrow.units]["temp"]+")</p>");var c=$('<div class="row tomorrow title">').append($('<div class="col-md-12"><h2><a href="tomorrow.php" alt="Tomorrows Weather" title="Tomorrow\'s Weather">Tomorrow</a></h2></div>')).append('<canvas id="icon-tomorrow" width="'+t+'" height="'+t+'"></canvas>');var h=$('<div class="row tomorrow summary">').append($('<div class="col-md-12">').append($("<p>"+e.tomorrow.summary+"</p>")));var p=$('<div class="row tomorrow result">').append(o).append(u);n.append(a).append(f).append(l);r.append(c).append(h).append(p);$("#subheading").text("Relative Weather for "+userLocation.city);$("#weatherDisplay").append(n).append(r);if(Math.round(s.diff)>0){r.addClass("hotter")}else if(Math.round(s.diff)<0){r.addClass("colder")}var d=new Skycons({color:"white"});d.add("icon-today",Skycons[e.today.icon.toUpperCase().replace(/-/gi,"_")]);d.add("icon-tomorrow",Skycons[e.tomorrow.icon.toUpperCase().replace(/-/gi,"_")]);d.play();var v=new google.maps.LatLng(userLocation.latitude,userLocation.longitude);var m={center:v,zoom:11};var g=$(window).height()>600?300:200;$("#map-canvas").css("min-height",g);$("#map-canvas").html("");var y=new google.maps.Map(document.getElementById("map-canvas"),m);var b=new google.maps.Marker({position:v,map:y});MakeVibe()}function twoDP(e){return Math.round(e*100)/100}function addSign(e){addition="";if(e>0)addition="+";else if(e==0)addition="&plusmn;";return addition+e}function highlight(e){clearTimeout(timer);if(e.hasClass("highlight")){e.removeClass("highlight");clearTimeout(timer2);timer2=setTimeout(function(){e.addClass("highlight");timer=setTimeout(function(){e.removeClass("highlight")},3e3)},50)}else{e.addClass("highlight");timer=setTimeout(function(){e.removeClass("highlight")},3e3)}}navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;$("#postcodeForm").submit(function(e){MakeVibe();getWeatherFromPostcode($("#postcode").val(),displayWeather);e.preventDefault()});jQuery().ready(function(){if(document.URL.indexOf("#debug")!=-1){$("#debug").css("display","block")}getWeatherFromLocation(displayWeather)});var units={si:{wind:"m/s",temp:"&deg;C",windMultiplier:1,tempMultiplier:1},us:{wind:"mph",temp:"&deg;f",windMultiplier:2.2,tempMultiplier:1.8},uk:{wind:"mph",temp:"&deg;C",windMultiplier:2.2,tempMultiplier:1},uk2:{wind:"mph",temp:"&deg;C",windMultiplier:2.2,tempMultiplier:1},ca:{wind:"kph",temp:"&deg;C",windMultiplier:3.6,tempMultiplier:1},auto:{wind:"m/s",temp:"&deg;C",windMultiplier:1,tempMultiplier:1}};var timer;var timer2;(function(){function e(e){if(e<10){return"0"+e}return e}Date.prototype.toWeatherString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z"}})()